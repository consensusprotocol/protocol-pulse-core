{% extends "base.html" %}

{% block title %}Launch Sequence #{{ sequence.id }} | Protocol Pulse{% endblock %}

{% block head %}
<style>
:root {
    --pp-red: #dc2626;
    --pp-dark: #0a0a0a;
    --pp-glass: rgba(10, 10, 10, 0.95);
}

.view-page {
    min-height: 100vh;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a0505 100%);
    padding: 100px 20px 60px;
}

.view-container {
    max-width: 900px;
    margin: 0 auto;
}

.back-link {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    color: rgba(255, 255, 255, 0.6);
    text-decoration: none;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    margin-bottom: 20px;
    transition: color 0.3s ease;
}

.back-link:hover {
    color: var(--pp-red);
}

.view-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 15px;
}

.view-title {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.5rem;
    color: #fff;
}

.status-badge {
    padding: 8px 16px;
    border-radius: 20px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    text-transform: uppercase;
}

.status-draft { background: rgba(255, 255, 255, 0.1); color: rgba(255, 255, 255, 0.6); }
.status-approved { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
.status-published { background: rgba(96, 165, 250, 0.2); color: #60a5fa; }

.content-section {
    background: var(--pp-glass);
    border: 1px solid rgba(220, 38, 38, 0.2);
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 20px;
}

.section-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9rem;
    color: var(--pp-red);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 15px;
}

.main-post {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1.1rem;
    color: #fff;
    line-height: 1.6;
    background: rgba(255, 255, 255, 0.03);
    padding: 20px;
    border-radius: 10px;
}

.char-count {
    text-align: right;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    color: rgba(255, 255, 255, 0.4);
    margin-top: 10px;
}

.thread-list, .draft-list {
    display: grid;
    gap: 12px;
}

.thread-item, .draft-item {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 10px;
    padding: 15px;
}

.thread-number {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    color: var(--pp-red);
    margin-bottom: 8px;
}

.thread-text, .draft-text {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.5;
}

.draft-type {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    color: var(--pp-red);
    text-transform: uppercase;
    margin-bottom: 8px;
}

.copy-btn {
    margin-top: 10px;
    padding: 8px 16px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 6px;
    color: rgba(255, 255, 255, 0.7);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.copy-btn:hover {
    background: var(--pp-red);
    border-color: var(--pp-red);
    color: #fff;
}

.meta-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.meta-item {
    background: rgba(255, 255, 255, 0.03);
    padding: 15px;
    border-radius: 10px;
}

.meta-label {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    color: rgba(255, 255, 255, 0.5);
    text-transform: uppercase;
    margin-bottom: 5px;
}

.meta-value {
    font-family: 'JetBrains Mono', monospace;
    font-size: 1rem;
    color: #fff;
}

.actions-bar {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    margin-top: 30px;
}

.action-btn {
    padding: 14px 24px;
    border-radius: 10px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 10px;
}

.action-btn-primary {
    background: var(--pp-red);
    border: none;
    color: #fff;
}

.action-btn-primary:hover {
    background: #b91c1c;
    color: #fff;
}

.action-btn-secondary {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.7);
}

.action-btn-secondary:hover {
    border-color: var(--pp-red);
    color: #fff;
}

.action-btn-success {
    background: rgba(34, 197, 94, 0.2);
    border: 1px solid #22c55e;
    color: #22c55e;
}

.action-btn-success:hover {
    background: #22c55e;
    color: #fff;
}
</style>
{% endblock %}

{% block content %}
<div class="view-page">
    <div class="view-container">
        <a href="/admin/launch-sequences" class="back-link">
            <i class="fas fa-arrow-left"></i> Back to Launch Sequences
        </a>
        
        <div class="view-header">
            <h1 class="view-title">Launch Sequence #{{ sequence.id }}</h1>
            <span class="status-badge status-{{ sequence.status }}">{{ sequence.status }}</span>
        </div>
        
        <div class="content-section">
            <div class="section-title">
                <i class="fas fa-comment"></i> Main Post
            </div>
            <div class="main-post">{{ sequence.primary_post_copy or 'No content generated' }}</div>
            {% if sequence.primary_post_copy %}
            <div class="char-count">{{ sequence.primary_post_copy|length }} / 280 characters</div>
            {% endif %}
            <button class="copy-btn" onclick="copyText('{{ sequence.primary_post_copy | e }}')">
                <i class="fas fa-copy"></i> Copy to Clipboard
            </button>
        </div>
        
        {% if sequence.thread_replies %}
        <div class="content-section">
            <div class="section-title">
                <i class="fas fa-list"></i> Thread Replies
            </div>
            <div class="thread-list">
                {% for tweet in sequence.thread_replies | from_json %}
                <div class="thread-item">
                    <div class="thread-number">Tweet {{ loop.index + 1 }}</div>
                    <div class="thread-text">{{ tweet }}</div>
                    <button class="copy-btn" onclick="copyText('{{ tweet | e }}')">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        
        <div class="content-section">
            <div class="section-title">
                <i class="fas fa-edit"></i> Reply Drafts
            </div>
            <div class="draft-list">
                {% for draft in drafts %}
                <div class="draft-item">
                    <div class="draft-type">{{ draft.strategy }}</div>
                    <div class="draft-text">{{ draft.text }}</div>
                    <button class="copy-btn" onclick="copyText('{{ draft.text | e }}')">
                        <i class="fas fa-copy"></i> Copy
                    </button>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <div class="content-section">
            <div class="section-title">
                <i class="fas fa-info-circle"></i> Metadata
            </div>
            <div class="meta-grid">
                <div class="meta-item">
                    <div class="meta-label">Content Type</div>
                    <div class="meta-value">{{ sequence.content_type or 'General' }}</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Velocity Prediction</div>
                    <div class="meta-value">{{ sequence.velocity_prediction|int if sequence.velocity_prediction else 'N/A' }}%</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Optimal Time</div>
                    <div class="meta-value">{{ sequence.posting_time if sequence.posting_time else 'Any' }}</div>
                </div>
                <div class="meta-item">
                    <div class="meta-label">Hashtags</div>
                    <div class="meta-value">{{ sequence.hashtags or 'None' }}</div>
                </div>
            </div>
        </div>
        
        <div class="actions-bar">
            {% if sequence.status == 'draft' %}
            <a href="/admin/launch-sequence/{{ sequence.id }}/approve" class="action-btn action-btn-success">
                <i class="fas fa-check"></i> Approve
            </a>
            {% endif %}
            {% if sequence.status == 'approved' %}
            <a href="/launch-console/{{ sequence.id }}" class="action-btn action-btn-primary">
                <i class="fas fa-rocket"></i> Open Launch Console
            </a>
            {% endif %}
            <a href="/admin/launch-sequence/{{ sequence.id }}/regenerate" class="action-btn action-btn-secondary">
                <i class="fas fa-sync"></i> Regenerate
            </a>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function copyText(text) {
    navigator.clipboard.writeText(text).then(() => {
        alert('Copied to clipboard!');
    });
}
</script>
{% endblock %}
