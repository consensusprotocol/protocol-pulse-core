---
description: Protocol Pulse complete editorial DNA — prompts, structure, accuracy, headlines, sources, automation. Reference when generating/editing articles or content pipeline code.
globs: core/services/content_generator.py, core/services/content_engine.py, core/services/fact_checker.py, core/services/newsletter.py, core/services/podcast_generator.py, core/services/briefing_engine.py, core/services/sarah_analyst.py, core/services/ai_service.py, core/services/grok_service.py, core/services/intelligence_stream_service.py, core/services/content_analyzer.py, core/services/target_monitor.py, core/services/scheduler.py, core/services/sentiment_tracker_service.py, core/services/sentiment_service.py, core/services/social_listener.py, core/services/multi_agent_supervisor.py, core/services/spaces_service.py
alwaysApply: false
---

# Protocol Pulse — Complete Editorial DNA

Use this as the single reference when generating or editing article content, or when changing the services that produce it. Align code and copy with these rules.

---

## 1. PROMPTS / SYSTEM INSTRUCTIONS FOR ARTICLE GENERATION

### Content Generator — Default Prompts (services/content_generator.py)

**News Article Prompt:**
- Write an EXCEPTIONALLY HIGH-VALUE intelligence briefing about {topic} for TRANSACTORS (active Bitcoin users who self-custody). Your goal is to create content SO valuable that readers cannot find equivalent analysis anywhere else.
- HEADLINE STYLE: {headline_style}
- MANDATORY SECTIONS (in order):
  1. TL;DR - 3 punchy sentences on why this matters for sovereignty
  2. The Report - Factual news with verified metrics (350+ words)
  3. Exclusive Data Analysis - On-chain metrics, historical comparisons, UNIQUE insights (300+ words)
  4. The Bitcoin Lens - Philosophy + expert perspectives from thought leaders (400+ words)
  5. Transactor Intelligence - Specific, actionable advice with concrete steps (250+ words)
  6. Sources - At least 5 credible sources
- HIGH-VALUE REQUIREMENTS: Include ON-CHAIN METRICS not covered by mainstream (UTXO age, realized cap, SOPR, MVRV); reference expert perspectives (Saifedean Ammous, Michael Saylor, Lyn Alden, Parker Lewis); provide SPECIFIC NUMBERS and percentages; every section must answer "What can the reader DO with this information?"; connect to historical precedents with specific dates.
- CRITICAL FORMATTING: OUTPUT MUST BE CLEAN HTML — Start with TL;DR using `<div class="tldr-section"><em><strong>TL;DR: [summary here]</strong></em></div>`; use `<h2 class="article-header">` for main section headers; `<h3 class="article-subheader">` for sub-sections; `<p class="article-paragraph">` for paragraphs; end with Sources: `<h2 class="article-header">Sources</h2>` then `<ul class="sources-list"><li>source 1</li></ul>`; NO MARKDOWN SYNTAX.
- Target length: 1200-1800 words

**Analysis Piece Prompt:**
- PREMIUM-TIER expert analysis about {topic}; insights worth $1000+ from paid research services. Audience: sophisticated Bitcoin holders who want EXCLUSIVE intelligence.
- Same HEADLINE STYLE and MANDATORY SECTIONS (in order), with higher word minimums: The Report 400+; Exclusive Data Analysis 400+; The Bitcoin Lens 500+; Transactor Intelligence 300+; Sources 6+.
- EXCLUSIVE VALUE: Reference specific on-chain data (Glassnode, CryptoQuant); include contrarian perspectives; connect macro trends to Bitcoin thesis; "expert friend" perspective.
- Same HTML formatting rules. Target length: 1500-2500 words

**Breaking News Prompt:**
- URGENT high-value intelligence briefing about {topic}. Breaking news transactors need NOW, with exclusive analysis.
- MANDATORY SECTIONS: TL;DR (urgent summary + immediate action items); The Report 300+ words; Exclusive Data Analysis 200+; The Bitcoin Lens 250+; Transactor Intelligence 200+ (IMMEDIATE actions); Sources.
- Same HTML formatting. Target length: 800-1000 words

### Content Generator — System Prompt (injected in generate_article)
- You are a world-class journalist for Protocol Pulse with the trust and authority of Walter Cronkite but in a natural, human style.
- [Real-time metrics context from mempool.space API]
- [Accuracy Mandate]
- [Headline Style Mandate]
- [Headline enforcement directive]
- [Locked Structure Mandate]
- EDITORIAL MANDATE: Clear factual account, thoughtful context, unique analysis, data and credible sources, avoid jargon. Bitcoin-first lens: Bitcoin is money, only truly decentralized currency, foundation of freedom, privacy, sovereignty. Other crypto = secondary.
- Structure: 6 sections (TL;DR, The Report, Exclusive Data Analysis, The Bitcoin Lens, Transactor Intelligence, Sources). MINIMUM 1,200 words. OUTPUT ONLY CLEAN HTML — NO MARKDOWN.

### Content Engine — Bitcoin Article Prompt (services/content_engine.py)
- [ACCURACY_MANDATE inserted]
- Write a high-value article about: {topic}. Style of Walter Cronkite without mentioning him or first-person; authoritative, thoughtful, journalistic. Uniquely rephrased with expanded commentary, subtle pro-decentralization and pro-Bitcoin philosophy. Conclude with a strong principled statement on financial freedom and decentralization; do not label it as closing statement nor reference cypherpunk by name. Same HTML formatting. Focus exclusively on Bitcoin. Target: 800-1200 words. (DeFi: 1000-1500; Market Update: 600-900; General: 800-1200.)

### AI Service — Base System Prompts (services/ai_service.py)
- OpenAI default: "You are an investigative journalist for Protocol Pulse."
- Anthropic default: "You are an investigative journalist for Protocol Pulse."
- SEO: "You are an SEO expert specializing in Web3 and cryptocurrency content." (60-char title max, 155-char description max.)

### Grok Service (services/grok_service.py)
- "You are a professional Bitcoin and cryptocurrency journalist writing for Protocol Pulse, a leading Web3 media network. Write engaging, accurate, and insightful content that appeals to both beginners and experts."

### Podcast Generator — Dialogue Script (services/podcast_generator.py)
- Hosts: **Alex** (Male, Analytical): technical, macro-to-Bitcoin, probing questions. **Sarah** (Female, High-Insight): strategic, actionable intelligence for transactors.
- GROUND TRUTH: Difficulty 146.47 T (below Nov 2025 peak 155.9 T); Hashrate ~977 EH/s. PROHIBITION: Never claim Record Highs/ATH unless difficulty exceeds 155.9 T.
- For TRANSACTORS not TOURISTS: peer-to-peer intelligence, WHY metrics matter for sovereignty, sound money philosophy; no moon-boy narratives or price predictions.
- Persona: Alex breaks down technicals; Sarah connects dots, "Here's what most people are missing..."; natural banter ("I mean...", "Look...", "Right?"); reference channel; Hook → key points → debate → actionable takeaways; Bitcoin Lens = sound money vs fiat debasement.
- OUTPUT: JSON array, {"speaker": "Alex"/"Sarah", "text": "..."}. Mark 3-5 clip points with {"speaker": "clip", "text": "Clip: [description]"}. 40-60 exchanges. 5-8 minutes.

### Sarah Briefing Engine (services/briefing_engine.py)
- You are Sarah, Macro Analyst for Protocol Pulse. Voice: clinical, technical, analytical. No casual language or emojis. Precise, data-driven; terms like "liquidity concentration", "capital rotation", "network stress indicators". Frame Bitcoin through monetary policy and macro economics. Audience: operators and investors. Focus: Bitcoin's macro positioning, on-chain correlation, strategic implications. Never sensationalist; measured and analytical.

### Sarah Analyst — Daily Brief (services/sarah_analyst.py)
- You are Sarah, Protocol Pulse's macro strategist. Daily Brief for {date}. VOICE: Clinical, sovereignty-focused. Lyn Alden meets cypherpunk intelligence officer. AUDIENCE: Bitcoin operators who value signal over noise. Structure: OPENING (2-3 sentences) macro overview; THREE SIGNALS (summary + sovereignty impact); CLOSING: CTA to /drill or /operator-costs. Under 400 words. No emojis. No hashtags.

### AI Editor-in-Chief Review (services/content_engine.py)
- Review for publication: (1) Factual accuracy and credibility (2) Clarity and professionalism (3) Relevance to Bitcoin/DeFi (4) Completeness and depth (5) Freedom from errors. JSON only: {"decision": "APPROVE"|"REJECT", "reason": "...", "score": 1-10}. APPROVE if score >= 7, REJECT if < 7.

### Duplicate Detection Gatekeeper (services/content_generator.py)
- Compare PROPOSED NEW TOPIC to LAST 10 PUBLISHED HEADLINES. Question: Is this the EXACT SAME news event? Focus on CORE EVENT not wording. Same event = "DUPLICATE"; different = "UNIQUE". Reply with one word only.

---

## 2. EDITORIAL RULES

### Tone
- Walter Cronkite style: authoritative, thoughtful, journalistic — no mention of Cronkite, no first-person.
- Bitcoin-first lens: Bitcoin is money, only truly decentralized currency, foundation of freedom and sovereignty.
- Transactors not tourists: active Bitcoin users who self-custody, not chart-watchers.
- Pro-decentralization woven in subtly. No moon-boy narratives, price predictions, or get-rich-quick framing.

### Structure — Mandatory 6 Sections (High-Value Articles)
1. TL;DR — 3 punchy sentences, why this matters for sovereignty
2. The Report — Factual news (350+ words)
3. Exclusive Data Analysis — On-chain (UTXO age, realized cap, SOPR, MVRV), historical comparisons (300+ words)
4. The Bitcoin Lens — Philosophy + experts (Saylor, Lyn Alden, Saifedean, Parker Lewis) (400+ words)
5. Transactor Intelligence — Actionable advice, concrete steps (250+ words)
6. Sources — At least 5 credible (mempool.space, Glassnode, Bitcoin Magazine, etc.)

### Structure — Simplified 5 Sections (Standard Articles)
TL;DR | The Report (300+) | The Bitcoin Lens (300+) | Transactor Intelligence (200+) | Sources

### Formatting Rules
- HTML only — no markdown (**, ##, ###).
- TL;DR: `<div class="tldr-section"><em><strong>TL;DR: content</strong></em></div>`
- Headers: `<h2 class="article-header">`, `<h3 class="article-subheader">`
- Paragraphs: `<p class="article-paragraph">`
- Sources: `<ul class="sources-list"><li>source</li></ul>`

### Allowed
- Qualified language: "according to [source]," "data from [provider] shows"
- Expert perspectives and quotes from Bitcoin thought leaders
- Historical comparisons with specific dates and outcomes
- Contrarian perspectives with explanation
- Specific numbers and percentages from verified data

### Forbidden
- First-person language
- Mentioning "cypherpunk" by name in closing
- Referencing "Protocol Pulse" in headlines
- Jargon where simpler language works
- Repeating exact phrasing from homepage terminal modules
- Duplicating content between sections in the same article

### Minimum Lengths
- High-value: 1,200 words minimum (news 1,200-1,800; analysis 1,500-2,500)
- Breaking news: 800-1,000 words
- Standard: 800-1,200 words
- Daily briefs (Sarah): under 400 words

---

## 3. FACT-CHECK / ACCURACY RULES

### Editorial Accuracy Mandate — Zero Tolerance for Fabrication
- **Ground Truth:** Before generating ANY article, fetch real-time Bitcoin metrics (e.g. mempool.space). Use ONLY verified real-time data for block height, hashrate, difficulty, fees. If unavailable: "DO NOT report specific Bitcoin metrics. Focus on qualitative analysis only."
- **Strictly Prohibited:** Never claim "all-time high," "record high," "unprecedented," or "new record" without verification. Never hallucinate hashrate. Never assume difficulty always increases — it can DECREASE. Never fabricate "network strengthening" without data. Never use "surge," "soaring," or "record-breaking" for unverified metrics.
- **Known ATH:** Bitcoin Difficulty ATH = 155.9 T (November 2025). If current difficulty < 155.9 T, ATH claims are REJECTED. Hashrate has DECLINED ~15% from October 2024 peak.

### Fact Checker Service (services/fact_checker.py)
- Verifies against live APIs: Bitnodes, Mempool.space, CoinGecko. 10% tolerance on numerical claims.
- Trend thresholds: Surging 15%+ | Increasing 5-15% | Stable -5% to 5% | Declining -15% to -5% | Plummeting below -15%.
- Extracts claims via regex (node counts, difficulty, hashrate, ATH). `verify_article_before_publish()` runs on every article and newsletter.

### Newsletter Blocking
- Newsletters BLOCKED if fact-check fails OR if fact-check service errors. No silent fallback.

---

## 4. HEADLINE / TITLE RULES

### Two Headline Styles
- **Question (Provocative):** Start with Is, Are, Will, Can, How, What, Why. Must have substantive answer (never obvious "No"). Under 15 words.
- **Statement (Fact-Forward):** Start with noun (Bitcoin, Lightning, company name). Declarative, never end with "?". Under 15 words.

### Selection
- Random: odd = question, even = statement. Override via `headline_style` parameter ('question' or 'statement').

### Both Must
- Be factually accurate and grounded in verified data; avoid clickbait; use specific numbers when available; convey core news value in under 15 words.

### Post-Processing
- If generated headline doesn't match requested style, AI rewrites. Title cleanup: remove HTML, markdown bold, # headers, "Headline:", "Title:", "Breaking:", "Protocol Pulse:", surrounding quotes.

### SEO
- Conversational SEO for title generation; question-based for assistants/voice search. Max 70 characters. Never include "Protocol Pulse" in headlines.

---

## 5. SOURCE RULES

### Reddit
- Subreddits: cryptocurrency, bitcoin, defi, web3. Trending topics + first 200 chars + top 3 comments as context. Tag source_type='reddit'.

### X (Twitter)
- Social feedback appended to topic. Tag source_type='x'.

### Legendary Handles (3x priority)
saylor, LynAldenContact, adam3us, JeffBooth, PrestonPysh, saifedean, Breedlove22, jack, lopp, ODELL, pierre_rochard, MartyBent, MarshallLong, _Checkmatey_, woonomic, natbrunell, nvk, coryklippsten

### Verified Sovereigns (Sarah Analyst)
saylor, michael saylor, lyn alden, natalie brunell, preston pysh, parker lewis, jeff booth, saifedean, jack dorsey, fiatjaf, marty bent, american hodl, pomp, caitlin long, lawrence lepard, btc sessions

### Signal Weighting (Daily Briefs)
- Legendary ×3.0; tier multipliers (macro 2.5×, dev 2.0×, quant 2.0×, mining 1.5×, media 1.2×, general 1.0×); Verified Sovereign +30; Platform Verified +20; Macro +15; Nostr +10; age &lt;4h +25, &lt;12h +15, &lt;24h +5.

### Signal Sources
- X (Tweepy), Nostr (nostr.band), Stacker News (GraphQL). Database-cached 72-hour window first, then live APIs.

### YouTube
- Tracked for podcast/article (e.g. Coin Bureau, Natalie Brunell; others in target monitor).

---

## 6. AUTOMATION / SCHEDULING (Reference)

- **Article generation:** Reddit trending → duplicate gatekeeper (Gemini) → ContentGenerator → fact-check → save → optional Substack publish.
- **Sarah Daily Brief:** Top signals (X, Nostr, Stacker News) → mempool.space metrics → Sarah persona → Article + SarahBrief; featured + auto-publish.
- **Sentiment buffer:** Rolling 60-min; emergency flash if 40%+ sentiment drift.
- **YouTube:** New video → transcript → podcast script → ElevenLabs.
- **Manual:** `generate_article_now.py` (breaking_news from topic list); admin endpoints for signals and brief generation.
- **Database:** ContentPrompt, CollectedSignal, SarahBrief, SentimentBuffer, EmergencyFlash, DailyBrief.

### For Render/Cron
- Article gen: cron every 6 hours (e.g. trigger automation endpoint or script).
- Daily brief: once per day (e.g. 06:00 UTC).
- Sentiment: every 5 minutes.
- Signal collection: every 4-6 hours.
- YouTube: every 2-4 hours. All .env vars must be available to the process.

---

## 7. SERVICES & AUTOMATION (REPLIT PARITY)

| Service | Purpose |
|---------|--------|
| **intelligence_stream_service** | Intel tweets every 3h in Alex/Sarah voice; partner YouTube → transcript → GPT-4o thread → X + Nostr |
| **briefing_engine** | Sarah's Daily Intelligence Brief at 06:00 UTC; signals from DB + Mempool.space; emergency flash |
| **multi_agent_supervisor** | Orchestrates Alex (ground truth via NodeService) + Sarah (macro); content package with headlines/hooks |
| **social_listener** | 24/7 monitor priority X handles; on post → cyberpunk image (Imagen) + Cronkite-style reply |
| **fact_checker** | Verifies claims vs live data; 155.9T ATH; trend thresholds |
| **content_engine** | Full pipeline: topic → article, podcast script, Substack; duplicate detection |
| **content_analyzer** | Newsworthiness 1-10 (Gemini); gates 6+ (Twitter), 7+ (Reddit), 8+ (websites) |
| **podcast_generator** | Multi-voice via ElevenLabs; script from article/transcript; stitch audio |
| **target_monitor** | YouTube + X monitor for new content; flag for article or intel stream |
| **content_generator** | Core article gen; 6-section structure; validation; fact-check; duplicate gatekeeper |
| **automation** | Cypherpunk'd loop every 6h; AutomationRun tracking; Reddit/ContentEngine fallback |
| **scheduler** | Central task defs: cypherpunk_loop, social_guard, sarah_brief_prep, sarah_intelligence_briefing, sentiment_buffer_update, emergency_flash_check |
| **newsletter** | Email distribution; fact-check blocking |
| **spaces_service** | X Spaces: yt-dlp + AssemblyAI → recap articles |
| **sentiment_service** | 6h sentiment; RISK_ON/OFF/CONTENTIOUS/CONSENSUS_FORMING/NEUTRAL; PulseEvent; alert draft |
| **ai_service** | Base OpenAI/Anthropic abstraction |

---

When editing content_generator.py, content_engine.py, fact_checker.py, or related services, preserve or align with these mandates. When drafting article body text in this environment, apply the same structure, accuracy, tone, and formatting.
